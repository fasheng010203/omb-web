<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta charset="utf-8"/>
    <title>Onemile后台管理系统</title>

    <meta name="description" content=""/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>

    <!-- bootstrap & fontawesome -->
    <link rel="stylesheet" href="/static/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/static/font-awesome/css/font-awesome.min.css"/>

    <!-- page specific plugin styles -->

    <!-- text fonts -->
    <link rel="stylesheet" href="/static/css/fonts.googleapis.com.css"/>

    <!-- ace styles -->
    <link rel="stylesheet" href="/static/css/ace.min.css" class="ace-main-stylesheet" id="main-ace-style"/>

    <!--[if lte IE 9]>
    <link rel="stylesheet" href="/static/css/ace-part2.min.css" class="ace-main-stylesheet"/>
    <![endif]-->
    <link rel="stylesheet" href="/static/css/ace-skins.min.css"/>
    <link rel="stylesheet" href="/static/css/ace-rtl.min.css"/>

    <!--[if lte IE 9]>
    <link rel="stylesheet" href="/static/css/ace-ie.min.css"/>
    <![endif]-->

    <link href="/static/css/bootstrap-tab.css" rel="stylesheet"/>

    <!-- ace settings handler -->
    <script src="/static/js/ace-extra.min.js"></script>

    <!-- HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries -->

    <!--[if lte IE 8]>
    <script src="/static/js/html5shiv.min.js"></script>
    <script src="/static/js/respond.min.js"></script>
    <![endif]-->
</head>

<body class="no-skin">
<div id="navbar" class="navbar navbar-default          ace-save-state">
    <div class="navbar-container ace-save-state" id="navbar-container">
        <div class="navbar-header pull-left">
            <a href="index.html" class="navbar-brand">
                <small>
                    <i class="fa"></i>
                    Onemile后台管理系统
                </small>
            </a>
        </div>
        <div class="navbar-buttons navbar-header pull-right" role="navigation">
            <ul class="nav ace-nav">

                <li class="light-blue dropdown-modal">
                    <a data-toggle="dropdown" href="#" class="dropdown-toggle">
                        <img class="nav-user-photo" src="/static/images/avatars/user.png" alt="Jason's Photo"/>
                        <span class="user-info">
									<small>欢迎您！</small>
									${realName!''}
								</span>

                        <i class="ace-icon fa fa-caret-down"></i>
                    </a>
                    <ul class="user-menu dropdown-menu-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">
                        <li>
                            <a href="#" onclick="updatePwd()">
                                <i class="ace-icon fa fa-cog"></i>
                                修改密码
                            </a>
                        </li>

                        <li class="divider"></li>

                        <li>
                            <a href="/logout">
                                <i class="ace-icon fa fa-power-off"></i>
                                退出
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</div>



<div class="main-container ace-save-state" id="main-container">
    <script type="text/javascript">
        try {
            ace.settings.loadState('main-container')
        } catch (e) {
        }
    </script>

    <div id="sidebar" class="sidebar    responsive    ace-save-state">
        <script type="text/javascript">
            try {
                ace.settings.loadState('sidebar')
            } catch (e) {
            }
        </script>
        <div class="sidebar-shortcuts" id="sidebar-shortcuts">
            <div class="sidebar-shortcuts-large" id="sidebar-shortcuts-large">
                <button class="btn btn-success">
                    <i class="ace-icon fa fa-signal"></i>
                </button>

                <button class="btn btn-info">
                    <i class="ace-icon fa fa-pencil"></i>
                </button>

                <button class="btn btn-warning">
                    <i class="ace-icon fa fa-users"></i>
                </button>

                <button class="btn btn-danger">
                    <i class="ace-icon fa fa-cogs"></i>
                </button>
            </div>

            <div class="sidebar-shortcuts-mini" id="sidebar-shortcuts-mini">
                <span class="btn btn-success"></span>

                <span class="btn btn-info"></span>

                <span class="btn btn-warning"></span>

                <span class="btn btn-danger"></span>
            </div>
        </div>

        <ul class="nav nav-list" id="menu"></ul>

        <div class="sidebar-toggle sidebar-collapse" id="sidebar-collapse">
            <i id="sidebar-toggle-icon" class="ace-icon fa fa-angle-double-left ace-save-state"
               data-icon1="ace-icon fa fa-angle-double-left" data-icon2="ace-icon fa fa-angle-double-right"></i>
        </div>
    </div>

    <div class="main-content">
        <div class="main-content-inner">

            <div class="page-content">


                <!--<div class="page-header">-->
                    <!--<h1>-->
                        <!--FAQ-->
                        <!--<small>-->
                            <!--<i class="ace-icon fa fa-angle-double-right"></i>-->
                            <!--frequently asked questions using tabs and accordions-->
                        <!--</small>-->
                    <!--</h1>-->
                <!--</div>&lt;!&ndash; /.page-header &ndash;&gt;-->




                <div class="row" style="margin-right:-10px;margin-left:-20px;margin-top: -7px">
                    <div class="col-xs-12" style="padding-left:0px;padding-right:0px;">
                        <!--<ul class="nav-my-tab">-->
                            <!--<li class="leftbackward">-->
                                <!--<a href="#"> <i class="fa fa-backward"></i></a>-->
                            <!--</li>-->
                            <!--<li class="middletab">-->
                                <!--<ul class="nav nav-tabs" role="tablist">-->
                                    <!--<li class="active"><a href="#Index" role="tab" data-toggle="tab">-->
                                        <!--<i class="fa fa-home"></i>系统首页</a>-->
                                    <!--</li>-->
                                <!--</ul>-->
                            <!--</li>-->
                            <!--<li class="rightforward"><a href="#">-->
                                <!--<i class="fa fa-forward"></i></a>-->
                            <!--</li>-->
                        <!--</ul>-->


                        <!-- PAGE CONTENT BEGINS -->




                        <div class="tab-content">
                            <!--<div role="tabpanel" class="tab-pane active" id="Index" style="height:100%;padding-left: 10px;">-->
                                <iframe id="iframe_tab_0" src="/device/locshow" width="99%" height="100%" onload="changeFrameHeight(this)"
                                        frameborder="no" border="0" marginwidth="0" marginheight="0" scrolling="false"
                                        allowtransparency="yes">
                                </iframe>
                            <!--</div>-->
                        </div>

                        <!-- PAGE CONTENT ENDS -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div id="modal-form" class="modal" aria-hidden="true" data-backdrop="static" data-keyboard="false" tabindex="-1">
    <div class="modal-dialog width-50">
        <div class="modal-content">
            <div class="modal-header" style="padding: 5px 15px 4px">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h5 id="modal_title" class="blue bigger">修改密码</h5>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-xs-12">
                        <form class="form-horizontal" id="addForm" method="get">

                            <div class="form-group">
                                <label class="control-label col-xs-12 col-sm-3 no-padding-right">原密码:</label>
                                <div class="col-xs-12 col-sm-9">
                                    <div class="clearfix">
                                        <input type="password" name="oldLoginPwd" id="oldLoginPwd"  class="col-xs-12 col-sm-6" required/>
                                    </div>
                                </div>
                            </div>
                            <div class="space-2"></div>
                            <div class="form-group">
                                <label class="control-label col-xs-12 col-sm-3 no-padding-right">新密码:</label>
                                <div class="col-xs-12 col-sm-9">
                                    <div class="clearfix">
                                        <input type="password" name="loginPwd" id="loginPwd" class="col-xs-12 col-sm-6" required/>
                                    </div>
                                </div>
                            </div>
                            <div class="space-2"></div>
                            <div class="form-group">
                                <label class="control-label col-xs-12 col-sm-3 no-padding-right">确认密码:</label>
                                <div class="col-xs-12 col-sm-9">
                                    <div class="clearfix">
                                        <input type="password" name="qrPwd" id="qrPwd" class="col-xs-12 col-sm-6"/>
                                    </div>
                                </div>
                            </div>
                        </form>

                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-sm" data-dismiss="modal">
                    <i class="ace-icon fa fa-times"></i>
                    关闭
                </button>

                <button onclick="save();" class="btn btn-sm btn-primary">
                    <i class="ace-icon fa fa-check"></i>修改
                </button>
            </div>
        </div>
    </div>
</div>


<!-- basic scripts -->

<!--[if !IE]> -->
<script src="/static/js/jquery-2.1.4.min.js"></script>

<!-- <![endif]-->

<!--[if IE]>
<script src="/static/js/jquery-1.11.3.min.js"></script>
<![endif]-->
<script type="text/javascript">
    if ('ontouchstart' in document.documentElement) document.write("<script src='/static/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
</script>
<script src="/static/js/bootstrap.min.js"></script>

<!-- page specific plugin scripts -->

<!-- ace scripts -->
<script src="/static/js/ace-elements.min.js"></script>
<script src="/static/js/ace.min.js"></script>

<script src="/static/js/sidebar-menu.js"></script>
<script src="/static/js/bootstrap-tab.js"></script>

<script src="/static/layer/layer.js"></script>
<script src="/static/js/zx-utils.js"></script>

<script type="text/javascript">
    $(function () {
        Zx.post({
            url: '/admin/getMenuList',
            loading: true,
            data: {},
            success: function (data) {
                $('#menu').sidebarMenu({
                    data: data
                });
            }
        });
    });

    function  updatePwd() {
        $('#modal-form').modal();
    }


    //保存
    function save() {
        // 验证表单
        var oldLoginPwd = $('#oldLoginPwd').val();
        var loginPwd = $('#loginPwd').val();
        var qrPwd = $('#qrPwd').val();
        if(oldLoginPwd==""){
            Zx.msg("请输入原密码！");
            return;
        }
        if(loginPwd==""){
            Zx.msg("请输入新密码！");
            return;
        }
        if(loginPwd.length<6){
            Zx.msg("新密码长度必须大于六位数！");
            return;
        }
        if(qrPwd==""){
            Zx.msg("请输入确认密码！");
            return;
        }
        if(loginPwd != qrPwd){
            Zx.msg("新密码和确认密码必须保持一致！");
            return;
        }
        if(loginPwd == oldLoginPwd){
            Zx.msg("新密码不能和原密码一样！");
            return;
        }
        var saveUrl = "/admin/updatePwd";
        layer.confirm('确定要修改密码？', {
                btn: ['确定', '取消']
            }, function () {
                Zx.post({
                    url: saveUrl,
                    loading: true,
                    data: {
                        oldLoginPwd: oldLoginPwd,
                        loginPwd: loginPwd
                    },
                    success: function (data) {
                        if (data.code == 0) {
                            Zx.msg('修改成功');
                            $("#modal-form").modal("toggle");
                        } else if (data.code == 1) {
                            Zx.msg(data.message);
                        }
                    }
                });
            }, function () {

            }
        );


    }

</script>
<!-- inline scripts related to this page -->
</body>
</html>
